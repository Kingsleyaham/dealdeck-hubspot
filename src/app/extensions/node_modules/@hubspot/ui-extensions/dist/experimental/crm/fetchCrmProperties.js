// Type guard for CrmPropertiesResponse
function isCrmPropertiesResponse(data) {
    if (
    // Confirm the data is a defined object
    data === null ||
        typeof data !== 'object' ||
        // Confirm all keys and values are strings
        !Object.keys(data).every((key) => typeof key === 'string' && typeof data[key] === 'string')) {
        return false;
    }
    return true;
}
export const fetchCrmProperties = async (propertyNames, propertiesUpdatedCallback) => {
    try {
        // eslint-disable-next-line hubspot-dev/no-confusing-browser-globals
        const response = await self.fetchCrmProperties(propertyNames, propertiesUpdatedCallback);
        if (!response.ok) {
            throw new Error(`Failed to fetch CRM properties: ${response.statusText}`);
        }
        const data = await response.json();
        if (!isCrmPropertiesResponse(data)) {
            throw new Error('Invalid response format');
        }
        return data;
    }
    catch (error) {
        if (error instanceof Error) {
            throw error;
        }
        throw new Error('Failed to fetch CRM properties: Unknown error');
    }
};
